<!DOCTYPE html>
<html lang="sv">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delar</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="icon" type="image/png" sizes="32x32" href="Infinity_Camper_Logo.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
</head>

<body>
    <!-- Topbar -->
    <header class="topbar">
        <img src="infi.camp.png" alt="Camp logo" class="topbar-img">

        <nav>
            <a href="#">Home</a>
            <a href="produkter.html">Våra Plåtisar</a>
            <a href="delar.html">Delar</a>

        </nav>

        <img src="CGT_bild-removebg-preview.png" alt="cgt bild" class="topbar-img">
    </header>

    <main>
        <div class="main-container">
            <h1>Delar</h1>
            <div id="delar-gallery" class="gallery"></div>
        </div>
    </main>

    <footer class="footer">
        <h2>Kontakt</h2>
        <p><strong>Telefon:</strong> +46735913525</p>
        <p><strong>E-mail:</strong> <a href="mailto:Info@cgtsweden.se">Info@cgtsweden.se</a></p>
        <div class="socials">
            <a href="https://www.facebook.com" target="_blank"><i class="fa-brands fa-square-facebook"></i></a>
            <a href="https://www.instagram.com" target="_blank"><i class="fa-brands fa-instagram"></i></a>
        </div>
    </footer>

    <!-- Modal -->
    <div id="modal" class="modal">
        <span class="close-btn">&times;</span>
        <div class="modal-content">
            <img id="modal-img" src="" alt="">
            <div class="modal-info">
                <h2 id="modal-title"></h2>
                <p><strong>Pris:</strong> <span id="modal-price"></span></p>
                <p id="modal-desc"></p>
            </div>
        </div>
    </div>

    <script>
        const wpApiUrl = "https://www.cgtsweden.se/wp-json/wp/v2/media?per_page=100";
        const delarCategoryId = 4; // ID för kategorin "Delar"

        fetch(wpApiUrl)
            .then(res => res.json())
            .then(data => {
                const gallery = document.getElementById("delar-gallery");

                // Filtrera bilder i kategorin "Delar"
                const filtered = data.filter(img => img.attachment_categories && img.attachment_categories.includes(delarCategoryId));

                // Skapa galleri
                gallery.innerHTML = filtered.map(img => `
                    <div class="gallery-item" 
                         data-title="${img.title.rendered}" 
                         data-price="${img.caption.rendered.replace(/(<([^>]+)>)/gi, '') || 'Kontakta oss'}" 
                         data-desc="${(img.description.rendered).replace(/(<([^>]+)>)/gi, '')}" 
                         data-src="${img.source_url}">
                        <img src="${img.source_url}" alt="${img.alt_text || 'Delar-bild'}">
                        <h3>${img.title.rendered}</h3>
                    </div>
                `).join("");

                // Modal logik
                const modal = document.getElementById("modal");
                const modalImg = document.getElementById("modal-img");
                const modalTitle = document.getElementById("modal-title");
                const modalPrice = document.getElementById("modal-price");
                const modalDesc = document.getElementById("modal-desc");
                const closeBtn = document.querySelector(".close-btn");

                document.querySelectorAll(".gallery-item").forEach(item => {
                    item.addEventListener("click", () => {
                        modal.style.display = "flex";
                        modalImg.src = item.dataset.src;
                        modalTitle.textContent = item.dataset.title;
                        modalPrice.textContent = item.dataset.price; // Nu hämtas Bildtext istället för alt-text
                        modalDesc.textContent = item.dataset.desc;
                    });
                });

                closeBtn.addEventListener("click", () => modal.style.display = "none");
                modal.addEventListener("click", (e) => {
                    if (e.target === modal) modal.style.display = "none";
                });
            })
            .catch(err => console.error("Fel vid hämtning av bilder:", err));
    </script>
</body>

</html>